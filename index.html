<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Descargar APK — Jesús María Conecta</title>
  <meta name="description" content="Descarga el APK oficial de Jesús María Conecta desde GitHub Releases." />
  <meta property="og:title" content="Descargar APK — Jesús María Conecta" />
  <meta property="og:description" content="Descarga el APK oficial desde GitHub. Versión, tamaño y QR." />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#0b3a75" />
  <style>
    :root{
      --primary:#0b3a75;
      --primary-2:#173f8a;
      --bg:#0b1220;
      --surface:#0f172a;
      --card:#0b1220;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --ring:#1d4ed8;
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Noto Sans","Helvetica Neue",sans-serif;
      background:radial-gradient(1200px 600px at 20% -10%,#11235033,transparent 60%),
                 radial-gradient(800px 400px at 90% 0,#1d4ed822,transparent 60%),
                 linear-gradient(180deg,#0a0f1e,#0a0f1e);
      color:var(--text);
      line-height:1.6;
    }
    .container{max-width:940px;margin:0 auto;padding:24px}

    header{
      padding:40px 0 24px;
    }
    .hero{
      background:linear-gradient(135deg,var(--primary),var(--primary-2) 70%);
      border:1px solid #1e293b;
      border-radius:28px;
      padding:28px;
      box-shadow:0 30px 60px rgba(2,6,23,.35), inset 0 0 0 1px rgba(255,255,255,.02);
      display:flex;align-items:center;gap:16px
    }
    .hero img{width:56px;height:56px;border-radius:14px;object-fit:cover;box-shadow:0 6px 20px rgba(0,0,0,.25)}
    .hero h1{margin:4px 0 2px;font-size:clamp(24px,4vw,34px);color:#fff}
    .lead{margin:0;color:#dbeafe}

    .grid{display:grid;gap:18px;margin-top:22px}
    @media(min-width:860px){.grid{grid-template-columns:1.35fr .9fr}}

    .card{
      background:linear-gradient(180deg, #0f172a, #0b1220);
      border:1px solid #1f2937;
      border-radius:var(--radius);
      padding:22px;
      box-shadow:0 18px 30px rgba(2,6,23,.35), inset 0 0 0 1px rgba(255,255,255,.02);
    }

    h2{margin:0 0 8px;font-size:20px;color:#e2e8f0}
    .muted{color:var(--muted);font-size:14px}
    .row{display:flex;flex-wrap:wrap;gap:12px;align-items:center}

    .btn{display:inline-flex;align-items:center;gap:10px;
      padding:14px 18px;border-radius:14px;border:1px solid #1e293b;cursor:pointer;
      font-weight:650;text-decoration:none;transition:transform .05s ease,opacity .15s ease, box-shadow .15s ease;
      box-shadow:0 10px 24px rgba(12,22,44,.25), inset 0 0 0 1px rgba(255,255,255,.04)}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:linear-gradient(180deg,#1e40af,#1d4ed8);color:#fff;border-color:#1d4ed8}
    .btn-primary[disabled]{opacity:.6;cursor:not-allowed}

    .meta{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
    .tag{display:inline-flex;align-items:center;gap:8px;background:#0b1220;padding:6px 10px;border-radius:999px;font-size:12px;color:#cbd5e1;border:1px solid #1e293b}

    .sep{height:1px;background:#1e293b;margin:16px 0}

    .qr-wrap{display:grid;place-items:center;background:#0b1220;border-radius:16px;border:1px solid #1e293b;padding:14px}
    .qr-wrap img{width:200px;height:200px;image-rendering:pixelated;filter:drop-shadow(0 8px 24px rgba(2,6,23,.5))}

    .small{font-size:12px;color:#94a3b8}
    code{background:#0b1220;border:1px solid #1e293b;padding:4px 8px;border-radius:8px;color:#e2e8f0}

    footer{padding:28px 0;color:#64748b;text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="hero">
        <img src="https://raw.githubusercontent.com/github/explore/main/topics/github-pages/github-pages.png" alt="Logo" />
        <div>
          <h1>Descarga la aplicación</h1>
          <p class="lead">APK oficial desde GitHub Releases • versión y QR automáticos</p>
        </div>
      </div>
    </header>

    <main>
      <div class="grid">
        <!-- Columna principal: Android únicamente -->
        <section class="card">
          <h2>Android</h2>
          <p class="muted" id="apk-status">Buscando el último APK público…</p>

          <div class="row" style="margin-top:10px">
            <a id="btn-apk" class="btn btn-primary" href="#" download disabled>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 3v10m0 0 4-4m-4 4-4-4M5 21h14" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span>Descargar APK</span>
            </a>
          </div>

          <div class="meta">
            <span class="tag" id="apk-version">v–</span>
            <span class="tag" id="apk-size">—</span>
          </div>

          <p class="muted" id="apk-notes" style="margin-top:8px"></p>

          <div class="sep"></div>
          <details>
            <summary class="muted">Instalar por ADB (avanzado)</summary>
            <p class="small">Conecta tu dispositivo y ejecuta:</p>
            <pre><code id="adb-code">adb install MiApp.apk</code></pre>
          </details>
        </section>

        <!-- Columna secundaria: QR -->
        <aside class="card">
          <h2>Escanea el QR</h2>
          <div class="qr-wrap">
            <img id="qr" alt="QR de descarga" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect width='100%25' height='100%25' fill='%230b1220'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='%2394a3b8' font-family='monospace' font-size='12'%3Eesperando URL%3C/text%3E%3C/svg%3E" />
          </div>
          <p class="small" id="qr-caption" style="text-align:center;margin-top:10px">Se generará al obtener el enlace del APK.</p>
        </aside>
      </div>
    </main>

    <footer>
      <p class="small">© <span id="year"></span> Municipio de Jesús María. Todos los derechos reservados.</p>
    </footer>
  </div>

<script>
  // === CONFIGURA AQUÍ ===
  const OWNER = "OWNER";               // ← tu usuario u organización (ej. "KevinTorres")
  const REPO  = "REPO";                // ← nombre del repositorio (ej. "jesus-maria-conecta")
  // Si quieres forzar un APK específico si no hay releases o el repo es privado:
  // Copia el link de tu release: https://github.com/OWNER/REPO/releases/download/vX.Y.Z/TuApp.apk
  const FALLBACK_APK_URL = "";
  // === FIN CONFIG ===

  const $ = (id)=>document.getElementById(id);
  $("year").textContent = new Date().getFullYear();

  async function findLatestApk() {
    if (!OWNER || !REPO || OWNER === "OWNER") {
      $("apk-status").textContent = "Configura OWNER y REPO en el código";
      return;
    }
    const api = `https://api.github.com/repos/${OWNER}/${REPO}/releases/latest`;
    try {
      const res = await fetch(api, { headers: { 'Accept': 'application/vnd.github+json' } });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      const assets = (data.assets||[]).filter(a=>/\.apk$/i.test(a.name));
      if (!assets.length) throw new Error('No hay assets .apk en la última release');
      const apk = assets[0];

      const url = apk.browser_download_url;
      const sizeMB = (apk.size/1024/1024).toFixed(2);

      // Actualiza UI
      $("btn-apk").href = url;
      $("btn-apk").download = apk.name;
      $("btn-apk").removeAttribute('disabled');
      $("apk-status").textContent = "APK listo para descargar.";
      $("apk-version").textContent = data.tag_name ? data.tag_name : 'Última versión';
      $("apk-size").textContent = `${sizeMB} MB`;
      $("adb-code").textContent = `adb install ${apk.name}`;

      // Notas (primeros 220 chars)
      const notes = (data.body||'').replace(/\r/g,'').trim();
      $("apk-notes").textContent = notes ? notes.slice(0,220)+(notes.length>220?'…':'') : '';

      // QR
      const qrURL = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(url)}`;
      $("qr").src = qrURL;
      $("qr-caption").textContent = apk.name;

    } catch (err) {
      console.warn(err);
      if (FALLBACK_APK_URL) {
        $("btn-apk").href = FALLBACK_APK_URL;
        $("btn-apk").removeAttribute('disabled');
        $("apk-status").textContent = "Usando enlace alternativo (fallback).";
        const qrURL = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(FALLBACK_APK_URL)}`;
        $("qr").src = qrURL;
        $("qr-caption").textContent = 'Enlace alternativo';
      } else {
        $("apk-status").textContent = "No se pudo obtener el APK. Verifica que la Release sea pública y contenga un .apk.";
      }
    }
  }

  findLatestApk();
</script>
</body>
</html>


